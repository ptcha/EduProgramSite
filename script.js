// Массив с данными о ТОП-10 укрупнённых группах профессий для участников СВО
const professionsData = [
    {
        id: 1,
        title: "IT и цифровые технологии",
        code: "09.00.00, 10.00.00, 01.00.00",
        description: "IT и цифровые технологии - это одни из самых востребованных и перспективных направлений в современном мире. Эти профессии связаны с разработкой программного обеспечения, защитой информации, созданием и обслуживанием компьютерных систем и сетей. Специалисты в этой области участвуют в создании инновационных решений, автоматизации бизнес-процессов и цифровизации различных сфер жизни. Участники СВО могут рассчитывать на льготное поступление и обучение на бюджетных местах по этим направлениям. Эти профессии обеспечивают стабильную занятость и высокий уровень дохода.",
        categories: [
            "Разработка ПО",
            "Информационная безопасность", 
            "Системное администрирование",
            "Аналитика данных и ИИ",
            "Робототехника"
        ],
        programs: [
            {
                level: "СПО",
                code: "09.02.06",
                name: "Сетевое и системное администрирование",
                qualification: "Системный администратор",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "06.026 Системный администратор ИКС",
                positions: ["Системный администратор", "Специалист отдела ИТ"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО"]
            },
            {
                level: "ВО",
                code: "09.03.03",
                name: "Прикладная информатика",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "06.027 Специалист по информационным системам",
                positions: ["Программист", "Аналитик данных", "Специалист по ИБ"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "СФО"]
            }
        ]
    },
    {
        id: 2,
        title: "Энергетика и электросети",
        code: "13.00.00, 14.00.00, 27.00.00",
        description: "Энергетика и электросети - это ключевые отрасли, обеспечивающие жизнедеятельность всей страны. Специалисты в этой сфере занимаются производством, передачей и распределением электроэнергии, обслуживанием электрических сетей и оборудования. Эти профессии требуют высокой ответственности и квалификации, так как от их работы зависит энергоснабжение промышленных объектов и населенных пунктов. В рамках программы СВО участники могут получить доступ к льготному поступлению и обучению на бюджетных местах. Профессии в энергетике обеспечивают стабильную занятость и социальные гарантии.",
        categories: [
            "Электросетевое хозяйство",
            "Атомная энергетика",
            "Возобновляемая энергетика",
            "Электрооборудование",
            "Энергоменеджмент"
        ],
        programs: [
            {
                level: "СПО",
                code: "13.02.11",
                name: "Техническая эксплуатация и обслуживание электрического и электромеханического оборудования",
                qualification: "Техник",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "27.003 Техник-электрик",
                positions: ["Электромонтер", "Слесарь-ремонтник", "Электрик"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "УФО"]
            },
            {
                level: "ВО",
                code: "13.03.02",
                name: "Электроэнергетика и электротехника",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "27.004 Инженер-электрик",
                positions: ["Инженер по релейной защите", "Энергетик", "Главный энергетик"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "СФО", "УФО"]
            }
        ]
    },
    {
        id: 3,
        title: "Строительство, архитектура и геоданные",
        code: "07.00.00, 08.00.00, 20.00.00, 21.00.00",
        description: "Строительство, архитектура и геоданные - это важнейшие сферы, обеспечивающие развитие инфраструктуры страны. Специалисты в этих областях проектируют и строят жилые и промышленные объекты, дороги, мосты и другие сооружения. Архитекторы и проектировщики создают современные и безопасные здания, а геодезисты обеспечивают точность измерений и разбивку объектов. Участники СВО могут получить льготное поступление и обучение на бюджетных местах по этим направлениям. Эти профессии востребованы в различных регионах страны и обеспечивают стабильную карьеру.",
        categories: [
            "Архитектура и проектирование",
            "Строительные технологии",
            "Геодезия и кадастр",
            "Горное дело",
            "ЖКХ и инфраструктура"
        ],
        programs: [
            {
                level: "СПО",
                code: "08.02.01",
                name: "Строительство и эксплуатация зданий и сооружений",
                qualification: "Техник-строитель",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "08.001 Техник-строитель",
                positions: ["Техник-строитель", "Прораб", "Мастер строительного участка"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО"]
            },
            {
                level: "ВО",
                code: "07.03.01",
                name: "Архитектура",
                qualification: "Бакалавр",
                duration: "5 лет (11 кл.)",
                profstandard: "07.001 Архитектор",
                positions: ["Архитектор", "Главный архитектор", "Проектный менеджер"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "СФО"]
            }
        ]
    },
    {
        id: 4,
        title: "Машиностроение и производственные технологии",
        code: "12.00.00, 15.00.00, 27.00.00",
        description: "Машиностроение и производственные технологии - это основа промышленного производства страны. Специалисты в этой области разрабатывают, производят и обслуживают различные виды техники и оборудования. Это включает автомобилестроение, авиастроение, станкостроение и другие отрасли промышленности. Машиностроение требует высокой квалификации и точности, так как от качества выпускаемой продукции зависит безопасность и эффективность производства. Участники СВО могут получить доступ к льготному поступлению и обучению на бюджетных местах. Эти профессии обеспечивают стабильную занятость на промышленных предприятиях по всей стране.",
        categories: [
            "Машиностроение",
            "Робототехника",
            "Сварочное производство",
            "Металлообработка",
            "Инженерное дело"
        ],
        programs: [
            {
                level: "СПО",
                code: "15.02.08",
                name: "Технология машиностроения",
                qualification: "Техник-технолог",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "15.001 Техник-технолог машиностроительного производства",
                positions: ["Технолог", "Инженер-технолог", "Начальник участка"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "УФО"]
            },
            {
                level: "ВО",
                code: "15.03.05",
                name: "Конструкторско-технологическое обеспечение машиностроительных производств",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "15.002 Инженер-конструктор",
                positions: ["Конструктор", "Инженер-технолог", "Проект-инженер"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "СФО", "УФО"]
            }
        ]
    },
    {
        id: 5,
        title: "Транспорт и беспилотные системы",
        code: "23.00.00, 25.00.00, 38.00.00",
        description: "Транспорт и беспилотные системы - это современные и быстро развивающиеся отрасли, обеспечивающие передвижение людей и грузов. Специалисты в этой сфере работают с различными видами транспорта: автомобильным, железнодорожным, авиационным и другими. Современные технологии включают развитие беспилотных летательных аппаратов, автоматизированные системы управления транспортом и логистику. Участники СВО могут получить доступ к льготному поступлению и обучению на бюджетных местах по этим направлениям. Эти профессии востребованы как в гражданских, так и в специализированных отраслях, включая оборонную промышленность.",
        categories: [
            "Автомобильный транспорт",
            "Авиация",
            "Железнодорожный транспорт",
            "Беспилотные системы",
            "Логистика"
        ],
        programs: [
            {
                level: "СПО",
                code: "23.02.03",
                name: "Эксплуатация и ремонт автомобильного транспорта",
                qualification: "Техник",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "23.001 Техник по ремонту и обслуживанию автомобилей",
                positions: ["Автомеханик", "Мастер по ремонту", "Слесарь-моторист"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО"]
            },
            {
                level: "ВО",
                code: "25.03.03",
                name: "Авиационные и ракетные комплексы",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "25.002 Инженер-конструктор авиационной техники",
                positions: ["Инженер-испытатель", "Конструктор БПЛА", "Оператор БПЛА"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "СФО", "ДФО"]
            }
        ]
    },
    {
        id: 6,
        title: "Нефтегазовая промышленность и недропользование",
        code: "18.00.00, 20.00.00, 21.00.00",
        description: "Нефтегазовая промышленность и недропользование - это стратегически важные отрасли экономики России. Специалисты в этих сферах занимаются разведкой, добычей, переработкой и транспортировкой нефти и газа. Это включает бурение скважин, разработку месторождений, переработку сырья и обеспечение экологической безопасности. Участники СВО могут получить доступ к льготному поступлению и обучению на бюджетных местах по этим направлениям. Эти профессии обеспечивают высокий уровень зарплаты и социальные гарантии, а также востребованы в различных регионах страны.",
        categories: [
            "Нефтегазовая отрасль",
            "Бурение скважин",
            "Переработка нефти",
            "Геология",
            "Недропользование"
        ],
        programs: [
            {
                level: "СПО",
                code: "21.02.01",
                name: "Разработка нефтяных и газовых месторождений",
                qualification: "Техник",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "21.001 Техник по добыче нефти и газа",
                positions: ["Слесарь-ремонтник", "Мастер добычи", "Техник по добыче"],
                federalDistricts: ["УФО", "СФО", "ДФО"]
            },
            {
                level: "ВО",
                code: "21.03.01",
                name: "Нефтегазовое дело",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "21.002 Инженер-нефтяник",
                positions: ["Инженер-нефтяник", "Главный инженер", "Руководитель проекта"],
                federalDistricts: ["УФО", "СФО", "ДФО"]
            }
        ]
    },
    {
        id: 7,
        title: "Здравоохранение и биотехнологии",
        code: "19.00.00, 31.00.00, 32.00.00, 33.00.00",
        description: "Здравоохранение и биотехнологии - это важнейшие сферы, обеспечивающие здоровье населения и развитие медицинской науки. Специалисты в этих областях работают в больницах, поликлиниках, лабораториях и научно-исследовательских институтах. Это включает врачей, фармацевтов, биотехнологов и других специалистов, обеспечивающих диагностику, лечение и профилактику заболеваний. Участники СВО могут получить доступ к льготному поступлению и обучению на бюджетных местах по этим направлениям. Эти профессии требуют высокой ответственности и квалификации, но обеспечивают стабильную карьеру и возможность помогать людям.",
        categories: [
            "Лечебное дело",
            "Фармацевтика",
            "Сестринское дело",
            "Биотехнологии",
            "Медицинская техника"
        ],
        programs: [
            {
                level: "СПО",
                code: "31.02.03",
                name: "Лечебное дело",
                qualification: "Фельдшер",
                duration: "3 года (11 кл.)",
                profstandard: "31.001 Фельдшер",
                positions: ["Фельдшер", "Фельдшер скорой помощи", "Фельдшер-анестезист"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО", "СФО"]
            },
            {
                level: "ВО",
                code: "31.05.01",
                name: "Лечебное дело",
                qualification: "Врач",
                duration: "6 лет (11 кл.)",
                profstandard: "31.002 Врач-терапевт",
                positions: ["Врач-терапевт", "Врач-педиатр участковый", "Специалист скорой помощи"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО", "СФО", "ДФО"]
            }
        ]
    },
    {
        id: 8,
        title: "Агро, ветеринария и пищевые технологии",
        code: "19.00.00, 35.00.00, 36.00.00, 43.00.00",
        description: "Агро, ветеринария и пищевые технологии - это отрасли, обеспечивающие продовольственную безопасность страны. Специалисты в этих сферах работают в сельскохозяйственных предприятиях, ветеринарных клиниках, пищевых производствах и научно-исследовательских институтах. Это включает выращивание сельскохозяйственных культур, разведение животных, контроль качества пищевой продукции и обеспечение ветеринарного благополучия. Участники СВО могут получить доступ к льготному поступлению и обучению на бюджетных местах по этим направлениям. Эти профессии востребованы в сельской местности и обеспечивают стабильную занятость с возможностью работать на современном оборудовании.",
        categories: [
            "Сельское хозяйство",
            "Ветеринария",
            "Пищевые технологии",
            "Растениеводство",
            "Животноводство"
        ],
        programs: [
            {
                level: "СПО",
                code: "35.02.07",
                name: "Механизация сельского хозяйства",
                qualification: "Техник-механик",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "35.001 Техник-механизатор",
                positions: ["Механизатор", "Тракторист", "Слесарь сельхозмашиностроения"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО"]
            },
            {
                level: "ВО",
                code: "36.03.01",
                name: "Ветеринарно-санитарная экспертиза",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "36.002 Ветеринарный врач",
                positions: ["Ветеринарный врач", "Ветеринарный фельдшер", "Специалист по защите животных"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "СФО"]
            }
        ]
    },
    {
        id: 9,
        title: "Образование и гуманитарные направления",
        code: "37.00.00, 39.00.00, 44.00.00",
        description: "Образование и гуманитарные направления - это сферы, формирующие интеллектуальный и культурный потенциал общества. Специалисты в этих областях работают в школах, вузах, культурных учреждениях и социальных организациях. Это включает учителей, преподавателей, психологов, социальных работников и других специалистов, обеспечивающих образовательный и воспитательный процесс. Участники СВО могут получить доступ к льготному поступлению и обучению на бюджетных местах по этим направлениям. Эти профессии требуют эмпатии, терпения и высокой квалификации, но обеспечивают возможность влиять на формирование будущих поколений.",
        categories: [
            "Образование",
            "Педагогика",
            "Психология",
            "Социальная работа",
            "Искусство и культура"
        ],
        programs: [
            {
                level: "СПО",
                code: "44.02.02",
                name: "Преподавание в начальных классах",
                qualification: "Учитель начальных классов",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "44.001 Учитель начальных классов",
                positions: ["Учитель начальных классов", "Воспитатель", "Методист начального образования"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО", "СФО"]
            },
            {
                level: "ВО",
                code: "44.03.05",
                name: "Педагогическое образование",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "44.002 Педагог",
                positions: ["Учитель", "Преподаватель", "Методист", "Руководитель образовательного проекта"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО", "СФО", "ДФО"]
            }
        ]
    },
    {
        id: 10,
        title: "Право, управление и коммуникации",
        code: "38.00.00, 40.00.00, 42.00.00, 46.00.00",
        description: "Право, управление и коммуникации - это сферы, обеспечивающие функционирование государственных и общественных институтов. Специалисты в этих областях работают в судах, прокуратуре, государственных органах, юридических фирмах и средствах массовой информации. Это включает юристов, следователей, специалистов по государственному управлению, специалистов по связям с общественностью и другие профессии, обеспечивающие правопорядок и эффективное управление. Участники СВО могут получить доступ к льготному поступлению и обучению на бюджетных местах по этим направлениям. Эти профессии обеспечивают карьерный рост и возможность влиять на развитие общества и государства.",
        categories: [
            "Юриспруденция",
            "Государственное управление",
            "Безопасность",
            "Политология",
            "Связи с общественностью"
        ],
        programs: [
            {
                level: "СПО",
                code: "40.02.01",
                name: "Право и организация социального обеспечения",
                qualification: "Юрист",
                duration: "2 г. 10 мес. (11 кл.)",
                profstandard: "40.001 Юрист",
                positions: ["Юрисконсульт", "Специалист по кадрам", "Специалист по юридической работе"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО"]
            },
            {
                level: "ВО",
                code: "40.03.01",
                name: "Юриспруденция",
                qualification: "Бакалавр",
                duration: "4 года (11 кл.)",
                profstandard: "40.002 Юрист",
                positions: ["Юрист", "Адвокат", "Следователь", "Прокурор", "Судья"],
                federalDistricts: ["ЦФО", "СЗФО", "ПФО", "ЮФО", "СФО", "ДФО"]
            }
        ]
    }
];

// Функция для генерации карточек профессий
function generateProfessionAccordions() {
    const container = document.getElementById('professions-container');
    container.innerHTML = ''; // Очищаем контейнер перед добавлением новых аккордеонов
    
    professionsData.forEach(profession => {
        // Create a short description (first 1-2 sentences)
        const shortDescription = profession.description.split('. ').slice(0, 2).join('. ') + '.';
        
        const accordion = document.createElement('div');
        accordion.className = 'accordion-item';
        accordion.innerHTML = `
            <div class="accordion-header">
                <h3 class="profession-title">${profession.title}</h3>
                <span class="accordion-icon">▼</span>
            </div>
            <div class="accordion-content">
                <div class="accordion-content-inner">
                    <div class="content-wrapper">
                        <div class="code-label">Коды УГС: <span class="code-value">${profession.code}</span></div>
                        <p class="profession-description">${shortDescription}</p>
                        <div class="categories-section">
                            <h4 class="skills-title">Базовые категории профессий:</h4>
                            <div class="skills-list">
                                ${profession.categories.map(category => 
                                    `<span class="skill-tag">${category}</span>`
                                ).join('')}
                            </div>
                        </div>
                        <div class="programs-section">
                            <h4 class="programs-title">Образовательные программы:</h4>
                            <div class="programs-list">
                                ${profession.programs.map(program => 
                                    `<div class="program-item">
                                        <div class="program-header">
                                            <strong>${program.level}:</strong> ${program.name} (${program.code})
                                        </div>
                                        <div class="program-details">
                                            <p><strong>Квалификация:</strong> ${program.qualification}. <strong>Срок:</strong> ${program.duration}</p>
                                        </div>
                                    </div>`
                                ).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="card-actions">
                        <a href="profession_detail.html?id=${profession.id}" class="btn apply-btn">Подробнее</a>
                        <a href="#" class="btn btn-primary" onclick="event.preventDefault(); alert('Переход на страницу поступления для ${profession.title.replace(/"/g, '')}');">Поступить</a>
                    </div>
                </div>
            </div>
        `;
        
        container.appendChild(accordion);
    });
    
    // Добавляем обработчики событий для аккордеонов
    setupAccordionEvents();
}

// Функция для настройки обработчиков событий аккордеонов
function setupAccordionEvents() {
    const accordionHeaders = document.querySelectorAll('.accordion-header');
    
    accordionHeaders.forEach(header => {
        header.addEventListener('click', function() {
            const accordionItem = this.parentElement;
            const isOpen = accordionItem.classList.contains('open');
            
            // Закрываем все аккордеоны
            document.querySelectorAll('.accordion-item').forEach(item => {
                item.classList.remove('open');
                item.querySelector('.accordion-icon').textContent = '▼';
            });
            
            // Если текущий аккордеон был закрыт, открываем его
            if (!isOpen) {
                accordionItem.classList.add('open');
                this.querySelector('.accordion-icon').textContent = '▲';
            }
        });
    });
}

// Функция для фильтрации профессий
function filterProfessions() {
    const educationLevel = document.getElementById('education-level').value;
    const educationType = document.getElementById('education-type').value;
    const formOfStudy = document.getElementById('form-of-study').value;
    const federalDistrict = document.getElementById('federal-district').value;
    const budgetPlaces = document.getElementById('budget-places').value;
    
    const container = document.getElementById('professions-container');
    container.innerHTML = ''; // Очищаем контейнер
    
    const filteredProfessions = professionsData.filter(profession => {
        // Проверяем, есть ли хотя бы одна подходящая программа для фильтров
        const hasMatchingProgram = profession.programs.some(program => {
            // Фильтр по уровню образования (СПО/ВО)
            if (educationType !== 'all' && program.level !== (educationType === 'spo' ? 'СПО' : 'ВО')) {
                return false;
            }
            
            // Фильтр по федеральному округу
            if (federalDistrict !== 'all' && !program.federalDistricts.includes(federalDistrict)) {
                return false;
            }
            
            return true;
        });
        
        return hasMatchingProgram;
    });
    
    if (filteredProfessions.length === 0) {
        container.innerHTML = '<p class="no-results">По заданным критериям не найдено подходящих профессий</p>';
    } else {
        filteredProfessions.forEach(profession => {
            const accordion = document.createElement('div');
            accordion.className = 'accordion-item';
            
            // Фильтруем программы по заданным критериям
            const matchingPrograms = profession.programs.filter(program => {
                // Фильтр по уровню образования (СПО/ВО)
                if (educationType !== 'all' && program.level !== (educationType === 'spo' ? 'СПО' : 'ВО')) {
                    return false;
                }
                
                // Фильтр по федеральному округу
                if (federalDistrict !== 'all' && !program.federalDistricts.includes(federalDistrict)) {
                    return false;
                }
                
                return true;
            });
            
            // Create a short description (first 1-2 sentences)
            const shortDescription = profession.description.split('. ').slice(0, 2).join('. ') + '.';
            
            accordion.innerHTML = `
                <div class="accordion-header">
                    <h3 class="profession-title">${profession.title}</h3>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <div class="content-wrapper">
                            <div class="code-label">Коды УГС: <span class="code-value">${profession.code}</span></div>
                            <p class="profession-description">${shortDescription}</p>
                            <div class="categories-section">
                                <h4 class="skills-title">Базовые категории профессий:</h4>
                                <div class="skills-list">
                                    ${profession.categories.map(category => 
                                        `<span class="skill-tag">${category}</span>`
                                    ).join('')}
                                </div>
                            </div>
                            <div class="programs-section">
                                <h4 class="programs-title">Образовательные программы:</h4>
                                <div class="programs-list">
                                    ${matchingPrograms.map(program => 
                                        `<div class="program-item">
                                            <div class="program-header">
                                                <strong>${program.level}:</strong> ${program.name} (${program.code})
                                            </div>
                                            <div class="program-details">
                                                <p><strong>Квалификация:</strong> ${program.qualification}. <strong>Срок:</strong> ${program.duration}</p>
                                            </div>
                                        </div>`
                                    ).join('')}
                                </div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <a href="profession_detail.html?id=${profession.id}" class="btn apply-btn">Подробнее</a>
                            <a href="#" class="btn btn-primary" onclick="event.preventDefault(); alert('Переход на страницу поступления для ${profession.title.replace(/"/g, '')}');">Поступить</a>
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(accordion);
        });
        
        // Добавляем обработчики событий для аккордеонов
        setupAccordionEvents();
    }
}

// Запускаем генерацию карточек после загрузки DOM
document.addEventListener('DOMContentLoaded', function() {
    generateProfessionAccordions();
    
    // Добавляем обработчик события для кнопки фильтрации
    document.getElementById('apply-filter').addEventListener('click', filterProfessions);
});